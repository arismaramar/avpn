#!/usr/bin/php
<?php
// Clear terminal
system("clear");

// Fungsi untuk memeriksa izin berdasarkan IP
function checking_sc() {
    $MYIP = trim(shell_exec("curl -sS ipv4.icanhazip.com"));
    $IZIN = shell_exec("curl -sS https://raw.githubusercontent.com/lunatixmyscript/lunaip/main/ip | awk '{print $4}'");

    if (strpos($IZIN, $MYIP) !== false) {
        echo "IZIN DITERIMA ANJING\n";
    } else {
        echo "\e[38;5;162m────────────────────────────────────────────\033[0m\n";
        echo "\033[44m          404 NOT FOUND AUTOSCRIPT          \033[0m\n";
        echo "\e[38;5;162m────────────────────────────────────────────\033[0m\n";
        echo "\n";
        echo "           \e[38;5;196mPERMISSION DENIED !\033[0m\n";
        echo "  \033[0;36mYour VPS IP $MYIP has been banned.\033[0m\n";
        echo "    \033[0;36mBuy access permissions for scripts.\033[0m\n";
        echo "            \033[0;36mContact Admin :\033[0m\n";
        echo "     \033[2;32mWhatsApp\033[0m wa.me/6285955333616\n";
        echo "\e[38;5;162m────────────────────────────────────────────\033[0m\n";
        exit(1);  // Keluar dengan status non-nol untuk menunjukkan kegagalan
    }
}

// Panggil fungsi untuk memeriksa izin
checking_sc();
system("clear");

######################################
$MYIP = trim(shell_exec("curl -sS ipv4.icanhazip.com"));
######################################
system("clear");
######################################
// // USERNAME IZIN IPP
$fp = fopen('/usr/bin/user', 'w');
$username = shell_exec("curl -sS https://raw.githubusercontent.com/lunatixmyscript/lunaip/main/ip | grep $MYIP | awk '{print $2}'");
fwrite($fp, $username);
fclose($fp);

$fp = fopen('/usr/bin/e', 'w');
$valid = shell_exec("curl -sS https://raw.githubusercontent.com/lunatixmyscript/lunaip/main/ip | grep $MYIP | awk '{print $3}'");
fwrite($fp, $valid);
fclose($fp);

system("clear");
######################################
// // DETAIL ORDER IZIN IP
//$username = file_get_contents('/usr/bin/user');
$oid = file_get_contents('/usr/bin/ver');
$exp = file_get_contents('/usr/bin/e');
######################################
system("clear");
// // DAYS LEFT
$d1 = strtotime($valid);
$d2 = strtotime(date("Y-m-d"));
// $certificate = (($d1 - $d2) / 86400);
system("clear");
######################################

// Hitung total akun vmess
$vme_total = shell_exec("grep -E \"^#vme-user# \" \"/etc/xray/vme.json\" | sed -E 's/^#vme-user# ([^ ]+).*/\1/' | awk '!seen[\$0]++'");
$VME = substr_count($vme_total, "\n");

// Hitung total akun vless
$vle_total = shell_exec("grep -E \"^#vle-user# \" \"/etc/xray/vle.json\" | sed -E 's/^#vle-user# ([^ ]+).*/\1/' | awk '!seen[\$0]++'");
$VLE = substr_count($vle_total, "\n");

// Hitung total akun trojan
$tro_total = shell_exec("grep -E \"^#tro-user# \" \"/etc/xray/tro.json\" | sed -E 's/^#tro-user# ([^ ]+).*/\1/' | awk '!seen[\$0]++'");
$TRO = substr_count($tro_total, "\n");

// Hitung total akun shadowsocks
$ssr_total = shell_exec("grep -E \"^#ssr-user# \" \"/etc/xray/ssr.json\" | sed -E 's/^#ssr-user# ([^ ]+).*/\1/' | awk '!seen[\$0]++'");
$SSR = substr_count($ssr_total, "\n");

// Hitung total akun noobzvpns
$nob_total = shell_exec("grep -E \"^#nob# \" \"/etc/noobzvpns/.noobzvpns\" | sed -E 's/^#nob# ([^ ]+).*/\1/' | awk '!seen[\$0]++'");
$NOB = substr_count($nob_total, "\n");

// Hitung total akun ssh openvpn
$ssh_total = shell_exec("grep -E \"^#ssh# \" \"/etc/ssh/.ssh.db\" | sed -E 's/^#ssh# ([^ ]+).*/\1/' | awk '!seen[\$0]++'");
$SSH = substr_count($ssh_total, "\n");

// // color validity
// // color format 38
$runn = "\e[38;5;14m";
$acc = "\e[38;5;146m";
$LO = "\e[38;5;162m";
$UK = "\e[38;5;99m";  // UNGU KOLOT
$BK = "\e[38;5;196m"; // BEREM KOLOT
$R1 = "\e[38;5;155m"; // HEJO SEMU BODAS
$R2 = "\e[38;5;49m";  // HEJO LIME / APEL
$BC = "\e[38;5;195m"; // BODAS CERAH PISAN
$HU = "\e[38;5;115m"; // HEJO SEMU ABU
$UB = "\e[38;5;147m"; // UNGU KABODASAN
$KT = "\e[38;5;187m"; // KONENG TARIGU
$Suffix = "\e[0m";

function Lunatic_Banner() {
    system("clear");
    echo "\e[38;5;162m  ┌━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┐\033[0m\n";
    echo "\e[38;5;162m  │\e[0m \033[44;1;97;1m              LUNATIC TUNNELING             \033[0m \e[38;5;162m│\e[0m\n";
    echo "\e[38;5;162m  └━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┘\033[0m\n";
}

function Service_System_Operating() {
    echo "\e[38;5;162m       ┌━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┐\033[0m\n";
    echo "\e[38;5;162m       │\e[38;5;196m SYSTEM : \e[31m" . shell_exec("cat /etc/os-release | grep -w ID | head -n1 | sed 's/=//g' | sed 's/\"//g' | sed 's/ID//g'") . "     \033[0m \n";
    echo "\e[38;5;162m       │\e[38;5;196m RAM : \e[31m" . shell_exec("free -m | awk 'NR==2 {print $2}'") . " MB   \033[0m \n";
    echo "\e[38;5;162m       │\e[38;5;196m UPTIME : \e[31m" . shell_exec("uptime -p | cut -d \" \" -f 2-10") . "\033[0m \n";
    echo "\e[38;5;162m       │\e[38;5;196m IPVPS : \e[31m" . trim(shell_exec("curl -s ipv4.icanhazip.com")) . "     \033[0m \n";
    echo "\e[38;5;162m       │\e[38;5;196m ISP : \e[31m" . shell_exec("cat /etc/xray/isp") . "    \033[0m \n";
    echo "\e[38;5;162m       │\e[38;5;196m DOMAIN : \e[31m" . shell_exec("cat /etc/xray/domain") . "    \033[0m \n";
    echo "\e[38;5;162m       └━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┘\033[0m\n";
}

Lunatic_Banner
Service_System_Operating

